var AutomateWoo,AW={};!function($){AW.init=function(){AW.params=automatewooLocalizeScript,AW.initTooltips(),AW.initWorkflowStatusSwitch(),AW.initShowHide(),$(document.body).on("wc-enhanced-select-init",function(){AW.initEnhancedSelects()})},AW.initTooltips=function(){$(".automatewoo-help-tip, .automatewoo-tiptip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},AW.initEnhancedSelects=function(){AW.initEnhancedSelectsLegacy(),$("select.automatewoo-json-search").filter(":not(.enhanced)").each(function(){var select2_args={allowClear:!!$(this).data("allow_clear"),placeholder:$(this).data("placeholder"),minimumInputLength:"1",escapeMarkup:function(m){return m},ajax:{url:AW.params.url.ajax,dataType:"json",quietMillis:250,data:function(params){var data={term:params.term,action:$(this).data("action")},sibling=$(this).data("pass-sibling");if(sibling){var $sibling=$('[name="'+sibling+'"]');$sibling.length&&(data.sibling=$sibling.val())}return data},processResults:function(data){var terms=[];return data&&$.each(data,function(id,text){terms.push({id:id,text:text})}),{results:terms}},cache:!0}};$(this).select2(select2_args).addClass("enhanced")})},AW.initEnhancedSelectsLegacy=function(){$(".automatewoo-json-search:not(select)").filter(":not(.enhanced)").each(function(){var select2_args={allowClear:!!$(this).data("allow_clear"),placeholder:$(this).data("placeholder"),minimumInputLength:1,escapeMarkup:function(m){return m},ajax:{url:ajaxurl,dataType:"json",quietMillis:250,data:function(term){var data={term:term,action:$(this).data("action")},sibling=$(this).data("pass-sibling");if(sibling){var $sibling=$('[name="'+sibling+'"]');$sibling.length&&(data.sibling=$sibling.val())}return data},results:function(data){var terms=[];return data&&$.each(data,function(id,text){terms.push({id:id,text:text})}),{results:terms}},cache:!0}};!0===$(this).data("multiple")?(select2_args.multiple=!0,select2_args.initSelection=function(element,callback){var data=$.parseJSON(element.attr("data-selected")),selected=[];return $(element.val().split(",")).each(function(i,val){selected.push({id:val,text:data[val]})}),callback(selected)},select2_args.formatSelection=function(data){return'<div class="selected-option" data-id="'+data.id+'">'+data.text+"</div>"}):(select2_args.multiple=!1,select2_args.initSelection=function(element,callback){return callback({id:element.val(),text:element.attr("data-selected")})}),$(this).select2(select2_args).addClass("enhanced")})},AW.initWorkflowStatusSwitch=function(){$(".aw-switch.js-toggle-workflow-status").click(function(){var $switch,new_state;($switch=$(this)).is(".aw-loading")||(new_state="on"===$switch.attr("data-aw-switch")?"off":"on",$switch.addClass("aw-loading"),$switch.attr("data-aw-switch",new_state),$.post(ajaxurl,{action:"aw_toggle_workflow_status",workflow_id:$switch.attr("data-workflow-id"),new_state:new_state},function(){$switch.removeClass("aw-loading")}))})},AW.price=function(float){var price=float.toFixed(2),symbol=AW.params.locale.currency_symbol;switch(AW.params.locale.currency_position){case"right":price+=symbol;break;case"right_space":price=price+" "+symbol;break;case"left":price=symbol+price;break;case"left_space":default:price=symbol+" "+price}return price},AW.block=function($el){$el.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},AW.initShowHide=function(){var update=function($el){var id=$el.data("automatewoo-bind"),value=$el.val();$("[data-automatewoo-show]").each(function(){var logic=$(this).data("automatewoo-show").split("=");logic[0]==id&&(-1!==logic[1].split("|").indexOf(value)?$(this).show():$(this).hide())}),$("[data-automatewoo-hide]").each(function(){var logic=$(this).data("automatewoo-hide").split("=");logic[0]==id&&(-1!==logic[1].split("|").indexOf(value)?$(this).hide():$(this).show())})};$(document).on("change","[data-automatewoo-bind]",function(){update($(this))}),$("[data-automatewoo-bind]").each(function(){update($(this))})},$(document).ready(function(){AW.init()})}(jQuery),jQuery(function($){(AutomateWoo={_email_preview_window:null,init:function(){this.init_notice_dismiss(),this.init_date_pickers()},notices:{success:function(message,$location){$location.length&&$location.before('<div class="automatewoo-notice updated fade"><p><strong>'+message+"</strong></p></div>")},error:function(message,$location){$location.length&&$location.before('<div class="automatewoo-notice error fade"><p><strong>'+message+"</strong></p></div>")},clear_all:function(){$(".automatewoo-notice").slideUp()}},init_notice_dismiss:function(){$(".aw-notice-licence-renew").on("click",".notice-dismiss",function(){$.ajax({url:ajaxurl,data:{action:"aw_dismiss_expiry_notice"}})}),$(".aw-notice-system-error").on("click",".notice-dismiss",function(){$.ajax({url:ajaxurl,data:{action:"aw_dismiss_system_error_notice"}})})},init_date_pickers:function(){$(".automatewoo-date-picker").datepicker({dateFormat:"yy-mm-dd",numberOfMonths:1,showButtonPanel:!0})},isEmailPreviewOpen:function(){return this._email_preview_window&&!this._email_preview_window.closed},openLoadingEmailPreview:function(){this.openPreviewWindow(AW.params.url.admin+"?automatewoo-email-preview-loader=1")},open_email_preview:function(type,args){var request={action:"aw_email_preview_ui",type:type,args:args},joiner=-1===AW.params.url.ajax.indexOf("?")?"?":"&";this.openPreviewWindow(AW.params.url.ajax+joiner+$.param(request))},openPreviewWindow:function(url){this._email_preview_window=window.open(url,"automatewoo_preview","titlebar=no,toolbar=no,height=768,width=860,resizable=yes,status=no")}}).init()});